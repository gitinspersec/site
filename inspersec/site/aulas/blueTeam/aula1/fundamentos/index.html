
<!doctype html>
<html lang="pt" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../../redTeam/aula4/hashs/">
      
      
        <link rel="next" href="../intro/">
      
      
        
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Fundamentos de Blue Team - inspersec</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#aula-01-fundamentos-de-blue-team" class="md-skip">
          Pular para conteúdo
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabeçalho">
    <a href="../../../.." title="inspersec" class="md-header__button md-logo" aria-label="inspersec" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            inspersec
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Fundamentos de Blue Team
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Buscar" placeholder="Buscar" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Pesquisar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpar" aria-label="Limpar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando busca
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegação" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="inspersec" class="md-nav__button md-logo" aria-label="inspersec" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    inspersec
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutoriais
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutoriais
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Instala%C3%A7%C3%A3o/horasComplementar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cadastro de horas de Atividade Complementar
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Instala%C3%A7%C3%A3o/kaliWindows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Instalando o Kali WSL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Instala%C3%A7%C3%A3o/vpnHaaukins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Instalando a VPN do Haaukins
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Instala%C3%A7%C3%A3o/vmWindows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Criando uma Máquina Virtual (VM)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Aulas
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Aulas
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Red Team
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Red Team
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Aula 1
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Aula 1
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redTeam/aula1/basicLinux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linux Básico
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redTeam/aula1/nmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Nmap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
        
          
          <label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Aula 2
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Aula 2
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redTeam/aula2/burpSuite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Burp Suite
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redTeam/aula2/criptografia/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Criptografia
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3" >
        
          
          <label class="md-nav__link" for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Aula 3
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Aula 3
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1_3_1" id="__nav_3_1_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Engenharia Social
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Engenharia Social
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redTeam/aula3/engenharia_social/sobre/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sobre
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redTeam/aula3/engenharia_social/gophish/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GoPhish
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redTeam/aula3/engenharia_social/setoolkit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setoolkit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redTeam/aula3/engenharia_social/sherlock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sherlock
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redTeam/aula3/engenharia_social/zphisher/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Zphisher
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redTeam/aula3/engenharia_social/prompt_injection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Prompt Injection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4" >
        
          
          <label class="md-nav__link" for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Aula 4
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Aula 4
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redTeam/aula4/introducao/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introdução
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redTeam/aula4/gobuster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GoBuster
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redTeam/aula4/john/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    John the Ripper
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redTeam/aula4/xss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    XSS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redTeam/aula4/wordlist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    WordList
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redTeam/aula4/hashs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hash
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Blue Team
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Blue Team
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Aula 1
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Aula 1
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Fundamentos de Blue Team
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Fundamentos de Blue Team
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Índice">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Índice
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-o-que-e-blue-team" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. O que é Blue Team
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-principios-de-seguranca-da-informacao" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Princípios de Segurança da Informação
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-modelos-mentais-do-adversario" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Modelos mentais do adversário
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Modelos mentais do adversário">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-cyber-kill-chain" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 Cyber Kill Chain
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-mitre-attck-e-d3fend" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 MITRE ATT&amp;CK e D3FEND
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-cyber-kill-chain-vs-attck-como-se-complementam" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 Cyber Kill Chain vs ATT&amp;CK: como se complementam
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-pyramid-of-pain-priorizando-deteccoes-eficazes" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4 Pyramid of Pain: priorizando detecções eficazes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-defesa-em-camadas-defense-in-depth" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Defesa em Camadas (Defense-in-Depth)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Defesa em Camadas (Defense-in-Depth)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-fisica" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Física
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-rede" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Rede
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-endpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3 Endpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-identidade" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.4 Identidade
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-aplicacao" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.5 Aplicação
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#46-dados" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.6 Dados
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#47-observabilidade" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.7 Observabilidade
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-boas-praticas-de-engenharia-de-deteccao" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Boas práticas de Engenharia de Detecção
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Boas práticas de Engenharia de Detecção">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-detections-as-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1 Detections-as-Code
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-testes-de-deteccao" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2 Testes de Detecção
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-cobertura-attck-e-navigator" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3 Cobertura ATT&amp;CK e Navigator
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-hipoteses-de-threat-hunting" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4 Hipóteses de Threat Hunting
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-mini-caso-pratico-ataque-hibrido-com-queries-de-deteccao" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Mini-caso prático: Ataque híbrido com queries de detecção
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Mini-caso prático: Ataque híbrido com queries de detecção">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cenario-campanha-de-ransomware-via-phishing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cenário: Campanha de ransomware via phishing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#queries-de-deteccao-kql-e-sigma" class="md-nav__link">
    <span class="md-ellipsis">
      
        Queries de detecção (KQL e Sigma)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Queries de detecção (KQL e Sigma)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-deteccao-office-iniciando-powershell-com-comando-codificado-execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Detecção: Office iniciando PowerShell com comando codificado (Execution)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-deteccao-alteracao-de-persistencia-via-chave-de-registro-persistence" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Detecção: Alteração de persistência via chave de registro (Persistence)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-deteccao-desabilitacao-do-windows-defender-defense-evasion" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Detecção: Desabilitação do Windows Defender (Defense Evasion)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-deteccao-dns-queries-para-dominios-dga-c2" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Detecção: DNS queries para domínios DGA (C2)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-deteccao-acesso-ao-processo-lsass-credential-access" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Detecção: Acesso ao processo LSASS (Credential Access)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-deteccao-uso-de-lolbin-regsvr32-para-download-remoto-defense-evasion-execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Detecção: Uso de LOLBin regsvr32 para download remoto (Defense Evasion / Execution)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-deteccao-movimento-lateral-via-psexec-lateral-movement" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Detecção: Movimento lateral via PsExec (Lateral Movement)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-deteccao-consentimento-de-aplicativo-oauth-suspeito-cloud-azure" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Detecção: Consentimento de aplicativo OAuth suspeito (Cloud - Azure)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-deteccao-acesso-anomalo-a-bucket-s3-exfiltration-aws" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. Detecção: Acesso anômalo a bucket S3 (Exfiltration - AWS)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#observacoes-sobre-as-queries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Observações sobre as queries
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-glossario-basico" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Glossário básico
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introdução ao Blue Team
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wireshark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Wireshark
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Aula 2
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Aula 2
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aula2/redes1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Redes Parte 1
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Aula 3
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Aula 3
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aula3/resdes2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Redes Parte 2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4" id="__nav_3_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Aula 4
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Aula 4
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aula4/criptografia_avancada/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Criptografia Avançada
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_5" >
        
          
          <label class="md-nav__link" for="__nav_3_2_5" id="__nav_3_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Aula 5
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Aula 5
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aula5/aula5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cloud Networking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aula5/containers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Containers e Segurança
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_5_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_5_3" id="__nav_3_2_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    GCP
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    GCP
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aula5/gcp/vpc_gcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    VPC no GCP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aula5/gcp/cloudrun_bucket/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deploy no GCP - Cloud Run + Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aula5/gcp/vm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deploy no GCP em VM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Game Hacking
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Game Hacking
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../GameHacking/introducao/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introdução
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Virus
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Virus
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Virus/Aula1/aula1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Virus Básico
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_2" >
        
          
          <label class="md-nav__link" for="__nav_3_4_2" id="__nav_3_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    RAT
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    RAT
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Virus/Rat/discordbot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Criando um Bot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Virus/Rat/rat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Criando um RAT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Entregas
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Entregas
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Projetos
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Projetos
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../entregas/projetos/projeto1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Projeto 1
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Índice">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Índice
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-o-que-e-blue-team" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. O que é Blue Team
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-principios-de-seguranca-da-informacao" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Princípios de Segurança da Informação
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-modelos-mentais-do-adversario" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Modelos mentais do adversário
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Modelos mentais do adversário">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-cyber-kill-chain" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 Cyber Kill Chain
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-mitre-attck-e-d3fend" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 MITRE ATT&amp;CK e D3FEND
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-cyber-kill-chain-vs-attck-como-se-complementam" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 Cyber Kill Chain vs ATT&amp;CK: como se complementam
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-pyramid-of-pain-priorizando-deteccoes-eficazes" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4 Pyramid of Pain: priorizando detecções eficazes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-defesa-em-camadas-defense-in-depth" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Defesa em Camadas (Defense-in-Depth)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Defesa em Camadas (Defense-in-Depth)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-fisica" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Física
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-rede" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Rede
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-endpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3 Endpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-identidade" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.4 Identidade
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-aplicacao" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.5 Aplicação
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#46-dados" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.6 Dados
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#47-observabilidade" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.7 Observabilidade
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-boas-praticas-de-engenharia-de-deteccao" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Boas práticas de Engenharia de Detecção
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Boas práticas de Engenharia de Detecção">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-detections-as-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1 Detections-as-Code
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-testes-de-deteccao" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2 Testes de Detecção
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-cobertura-attck-e-navigator" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3 Cobertura ATT&amp;CK e Navigator
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-hipoteses-de-threat-hunting" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4 Hipóteses de Threat Hunting
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-mini-caso-pratico-ataque-hibrido-com-queries-de-deteccao" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Mini-caso prático: Ataque híbrido com queries de detecção
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Mini-caso prático: Ataque híbrido com queries de detecção">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cenario-campanha-de-ransomware-via-phishing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cenário: Campanha de ransomware via phishing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#queries-de-deteccao-kql-e-sigma" class="md-nav__link">
    <span class="md-ellipsis">
      
        Queries de detecção (KQL e Sigma)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Queries de detecção (KQL e Sigma)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-deteccao-office-iniciando-powershell-com-comando-codificado-execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Detecção: Office iniciando PowerShell com comando codificado (Execution)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-deteccao-alteracao-de-persistencia-via-chave-de-registro-persistence" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Detecção: Alteração de persistência via chave de registro (Persistence)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-deteccao-desabilitacao-do-windows-defender-defense-evasion" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Detecção: Desabilitação do Windows Defender (Defense Evasion)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-deteccao-dns-queries-para-dominios-dga-c2" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Detecção: DNS queries para domínios DGA (C2)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-deteccao-acesso-ao-processo-lsass-credential-access" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Detecção: Acesso ao processo LSASS (Credential Access)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-deteccao-uso-de-lolbin-regsvr32-para-download-remoto-defense-evasion-execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Detecção: Uso de LOLBin regsvr32 para download remoto (Defense Evasion / Execution)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-deteccao-movimento-lateral-via-psexec-lateral-movement" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Detecção: Movimento lateral via PsExec (Lateral Movement)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-deteccao-consentimento-de-aplicativo-oauth-suspeito-cloud-azure" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Detecção: Consentimento de aplicativo OAuth suspeito (Cloud - Azure)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-deteccao-acesso-anomalo-a-bucket-s3-exfiltration-aws" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. Detecção: Acesso anômalo a bucket S3 (Exfiltration - AWS)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#observacoes-sobre-as-queries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Observações sobre as queries
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-glossario-basico" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Glossário básico
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="aula-01-fundamentos-de-blue-team">Aula 01 — Fundamentos de Blue Team</h1>
<blockquote>
<p>Objetivo: apresentar de forma clara e aprofundada os principais conceitos, estruturas e práticas do Blue Team, explicando termos, exemplos e referências para estudo e aplicação prática.</p>
</blockquote>
<hr />
<h2 id="1-o-que-e-blue-team">1. O que é Blue Team</h2>
<p>O termo "Blue Team" refere-se ao grupo responsável pela defesa cibernética de uma organização. O Blue Team é formado por pessoas, processos e tecnologias que trabalham juntos para prevenir, detectar, responder e recuperar de incidentes de segurança. O objetivo é garantir a continuidade dos negócios, proteger dados e ativos, e melhorar continuamente a postura de segurança.</p>
<p>Entre as funções do Blue Team, destacam-se:</p>
<p><strong>Security Operation Centers (SOCs)</strong> — Centros de Operações de Segurança, que podem ser divididos em diferentes níveis (Tiers 1, 2 e 3). O Tier 1 realiza o monitoramento inicial e triagem de alertas, o Tier 2 aprofunda investigações e responde a incidentes mais complexos, e o Tier 3 lida com ameaças avançadas e análise forense. É importante diferenciar este SOC (Security Operation Center) de outros usos da sigla, como System on Chip, pois aqui tratamos exclusivamente do contexto de segurança cibernética.</p>
<p><strong>Engenharia de Detecção</strong> — Profissionais que desenvolvem e mantêm regras de detecção, pipelines de logs e conteúdo em plataformas como SIEM (Security Information and Event Management) e EDR (Endpoint Detection and Response). Eles aplicam o conceito de "detections-as-code", tratando regras de detecção como código versionado.</p>
<p><strong>Resposta a Incidentes (IR)</strong> — Equipe responsável por coordenar a contenção, erradicação e recuperação de incidentes, além de promover o aprendizado pós-incidente (lessons learned).</p>
<p><strong>Threat Hunting</strong> — Atividade proativa de busca por indicadores de comprometimento (IOCs) e indicadores de atividade (IOAs) sem depender apenas de alertas automáticos. O objetivo é encontrar ameaças que passaram despercebidas pelos controles tradicionais.</p>
<p><strong>Forense e Inteligência</strong> — Análise detalhada de discos, memória e tráfego de rede para entender a origem e o impacto de incidentes, além de produzir inteligência sobre ameaças (threat intelligence).</p>
<p><strong>Gestão de Vulnerabilidades e Ativos</strong> — Processo de identificar, priorizar e corrigir vulnerabilidades em sistemas e inventariar ativos críticos.</p>
<p><strong>GRC (Governança, Risco e Conformidade)</strong> — Área que define políticas, avalia riscos e garante conformidade com normas e legislações.</p>
<p><br></p>
<p><strong>Referências:</strong>
- <a href="https://www.ibm.com/topics/blue-team">IBM: O que é Blue Team?</a>
- <a href="https://www.microsoft.com/en-us/security/business/security-101/what-is-blue-team">Microsoft: Blue Team vs Red Team</a></p>
<hr />
<h2 id="2-principios-de-seguranca-da-informacao">2. Princípios de Segurança da Informação</h2>
<p>Os princípios de segurança da informação são a base para todas as decisões e controles em uma operação defensiva. O modelo mais conhecido é a <strong>Tríade CIA</strong>:</p>
<ul>
<li><strong>Confidencialidade:</strong> garantir que apenas pessoas autorizadas tenham acesso à informação.</li>
<li><strong>Integridade:</strong> assegurar que a informação não seja alterada de forma não autorizada.</li>
<li><strong>Disponibilidade:</strong> garantir que a informação esteja acessível quando necessário.</li>
</ul>
<p>O modelo <strong>Parkerian Hexad</strong> amplia a tríade CIA, incluindo:
- <strong>Autenticidade:</strong> garantir que a informação é genuína.
- <strong>Utilidade:</strong> a informação deve ser útil para quem precisa.
- <strong>Possessão:</strong> controle físico ou lógico sobre a informação.</p>
<p>Além desses, destacam-se princípios operacionais:
- <strong>Menor Privilégio:</strong> cada usuário ou sistema deve ter apenas as permissões estritamente necessárias.
- <strong>Necessidade de Saber:</strong> acesso concedido apenas a quem realmente precisa.
- <strong>Segurança por padrão (default deny):</strong> sistemas devem ser projetados para negar acesso, exceto quando explicitamente permitido.
- <strong>Segregação de funções (SoD):</strong> dividir responsabilidades para evitar conflitos de interesse e fraudes.
- <strong>Observabilidade by design:</strong> projetar sistemas para gerar telemetria útil desde o início.
- <strong>Zero Trust:</strong> nunca confiar automaticamente em nada, mesmo dentro da rede — sempre verificar e validar.</p>
<p>Esses princípios orientam a arquitetura, a escolha de ferramentas e a priorização de controles.</p>
<p><strong>Referências:</strong>
- <a href="https://datatracker.ietf.org/doc/html/rfc2196">RFC 2196 - Site Security Handbook</a>
- <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-12r1.pdf">NIST SP 800-12: An Introduction to Computer Security PDF</a></p>
<hr />
<h2 id="3-modelos-mentais-do-adversario">3. Modelos mentais do adversário</h2>
<p>Para defender bem, é fundamental entender como os atacantes pensam e estruturam suas ações. Dois modelos amplamente usados são o <strong>Cyber Kill Chain</strong> e o <strong>MITRE ATT&amp;CK</strong>. Eles possuem abordagens diferentes e se complementam na prática.</p>
<hr />
<h3 id="31-cyber-kill-chain">3.1 Cyber Kill Chain</h3>
<p>O <strong>Cyber Kill Chain</strong>, criado pela Lockheed Martin em 2011, descreve o ataque cibernético como uma <strong>cadeia sequencial de 7 etapas</strong>. A ideia central é que, se você conseguir interromper o ataque em qualquer uma dessas etapas, a cadeia se quebra e o ataque falha.</p>
<p><strong>Etapas da Kill Chain:</strong></p>
<ol>
<li>
<p><strong>Reconhecimento (Reconnaissance):</strong> o atacante coleta informações sobre o alvo — domínios, IPs públicos, funcionários no LinkedIn, tecnologias usadas (ex: servidores expostos no Shodan). Pense nisso como o atacante estudando a porta antes de tentar abri-la.</p>
</li>
<li>
<p><strong>Arsenalização (Weaponization):</strong> o atacante prepara a "arma" — um documento Office com macro maliciosa, um exploit kit, ou um payload customizado. Esta etapa geralmente ocorre <strong>fora da rede</strong> do alvo, então é difícil de detectar diretamente, mas é possível obter inteligência sobre kits conhecidos (ex: ransomware builders).</p>
</li>
<li>
<p><strong>Entrega (Delivery):</strong> a arma chega ao alvo — via e-mail de phishing, link malicioso, drive-by download (site comprometido que infecta visitantes), ou até pen drive deixado no estacionamento. Aqui, controles como filtros de e-mail, proxies e treinamento de usuários são cruciais.</p>
</li>
<li>
<p><strong>Exploração (Exploitation):</strong> o código malicioso é executado — a macro roda, a vulnerabilidade é explorada, o usuário clica no link. É o momento em que o atacante "entra" no sistema. Exemplo: CVE-2017-0199 permitia que documentos RTF executassem código apenas ao serem abertos.</p>
</li>
<li>
<p><strong>Instalação (Installation):</strong> o atacante estabelece <strong>persistência</strong> (capacidade de sobreviver a reinicializações) — cria uma chave no registro do Windows, instala um serviço malicioso, ou adiciona um cronjob no Linux. Exemplo: malware cria <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code> para iniciar com o sistema.</p>
</li>
<li>
<p><strong>Comando e Controle (C2, Command and Control):</strong> o malware "liga de volta" para o servidor do atacante, estabelecendo comunicação contínua. Pode usar HTTP/HTTPS, DNS, ou protocolos customizados. Exemplo: beaconing periódico a cada 10 minutos para receber instruções. Este é um dos pontos mais ricos para detecção (DNS incomum, conexões para IPs suspeitos, padrões de tráfego regulares).</p>
</li>
<li>
<p><strong>Ações sobre o objetivo (Actions on Objectives):</strong> o atacante finalmente executa seu objetivo — roubar dados (exfiltração), criptografar arquivos (ransomware), sabotar sistemas, ou espionar. Pode incluir movimento lateral (pular para outros computadores na rede), escalada de privilégios (virar administrador), e descoberta de ativos críticos.</p>
</li>
</ol>
<blockquote>
<p><strong>Nota rápida:</strong> <em>C2 (Command and Control)</em> é como o "telefone secreto" entre o atacante e o computador infectado. O malware regularmente "chama" o servidor do atacante para pedir instruções, como um agente secreto reportando para a central.</p>
</blockquote>
<p><strong>Limitações da Kill Chain no contexto moderno:</strong></p>
<ul>
<li><strong>Não cobre movimento lateral explicitamente:</strong> em ambientes complexos (Active Directory, cloud híbrida), o atacante raramente para após o primeiro host comprometido. Ele pivota internamente, rouba credenciais, e espalha-se — a Kill Chain original trata isso apenas como "Ações sobre o objetivo".</li>
<li><strong>Foco em malware tradicional:</strong> ataques modernos frequentemente abusam de ferramentas legítimas (LOLBins — Living Off the Land Binaries, como PowerShell, WMI, PsExec) e identidade (credenciais roubadas, OAuth malicioso), sem "arsenalizar" um payload clássico.</li>
<li><strong>Cloud e SaaS:</strong> em ataques diretos a APIs ou aplicações SaaS (ex: comprometer conta Office 365 via credential stuffing), várias etapas da Kill Chain simplesmente não se aplicam.</li>
</ul>
<p>Apesar disso, a Kill Chain continua valiosa como narrativa de ataque e para comunicação com gestores e não-técnicos, pois sua linearidade é intuitiva.</p>
<hr />
<h3 id="32-mitre-attck-e-d3fend">3.2 MITRE ATT&amp;CK e D3FEND</h3>
<p>O <strong>MITRE ATT&amp;CK</strong> (Adversarial Tactics, Techniques, and Common Knowledge) é um <strong>framework não-linear</strong> que organiza o conhecimento sobre ataques reais em uma matriz de <strong>táticas</strong> (o <em>porquê</em> — objetivos do atacante) e <strong>técnicas</strong> (o <em>como</em> — métodos usados).</p>
<p><strong>Diferença fundamental:</strong>
- Kill Chain é sequencial: Reconhecimento → Entrega → Exploração → ...
- ATT&amp;CK é matricial: o atacante pode usar várias técnicas em paralelo, revisitar táticas, ou pular etapas.</p>
<p><strong>Principais táticas do ATT&amp;CK (Enterprise):</strong></p>
<ol>
<li><strong>Reconnaissance (Reconhecimento):</strong> coleta externa de informações.</li>
<li><strong>Resource Development (Desenvolvimento de Recursos):</strong> preparação de infraestrutura (domínios, servidores C2, contas comprometidas).</li>
<li><strong>Initial Access (Acesso Inicial):</strong> como o atacante entra — phishing, exploits públicos, credenciais válidas, supply chain.</li>
<li><strong>Execution (Execução):</strong> como o código roda — scripts, binários, componentes do SO.</li>
<li><strong>Persistence (Persistência):</strong> como o atacante mantém acesso — chaves de registro, serviços, contas backdoor.</li>
<li><strong>Privilege Escalation (Escalada de Privilégios):</strong> como o atacante se torna admin/root.</li>
<li><strong>Defense Evasion (Evasão de Defesas):</strong> como o atacante esconde atividade — desabilitar antivírus, obfuscar código, mascarar processos.</li>
<li><strong>Credential Access (Acesso a Credenciais):</strong> roubo de senhas — dump de LSASS, keylogging, ataques a Kerberos.</li>
<li><strong>Discovery (Descoberta):</strong> mapear a rede, usuários, processos, compartilhamentos.</li>
<li><strong>Lateral Movement (Movimento Lateral):</strong> pular para outros sistemas — Pass-the-Hash, RDP, WMI remoto.</li>
<li><strong>Collection (Coleta):</strong> juntar dados de interesse — screenshots, arquivos, e-mails.</li>
<li><strong>Command and Control (C2):</strong> canais de comunicação com servidores externos.</li>
<li><strong>Exfiltration (Exfiltração):</strong> roubar dados para fora — via HTTP, FTP, DNS tunneling, cloud storage.</li>
<li><strong>Impact (Impacto):</strong> causar danos — ransomware, destruição de dados, sabotagem.</li>
</ol>
<blockquote>
<p><strong>Nota rápida:</strong> <em>Lateral Movement</em> é quando o atacante, já dentro da rede, "pula" de um computador comprometido para outro, espalhando-se internamente como um vírus em uma escola.</p>
</blockquote>
<p><strong>Como usar o ATT&amp;CK:</strong></p>
<ul>
<li><strong>Mapear cobertura de detecção:</strong> sua organização detecta Pass-the-Hash? Detecta PowerShell Empire C2? Use a ferramenta <a href="https://mitre-attack.github.io/attack-navigator/">ATT&amp;CK Navigator</a> para visualizar lacunas.</li>
<li><strong>Priorizar casos de uso:</strong> analise incidentes passados ou threat intelligence relevante ao seu setor. Quais técnicas são mais usadas contra você? Priorizá-las.</li>
<li><strong>Threat Hunting:</strong> construir hipóteses baseadas em técnicas — "vamos caçar evidências de T1003.001 (LSASS Memory Dump) nos últimos 30 dias".</li>
<li><strong>Purple Team:</strong> combinar Red Team (simular ataques) com Blue Team (testar detecções) usando técnicas ATT&amp;CK específicas.</li>
</ul>
<p><strong>MITRE D3FEND:</strong></p>
<p>O <strong>D3FEND</strong> é o complemento defensivo do ATT&amp;CK. Ele cataloga <strong>contramedidas</strong> (ex: Application Hardening, Credential Hardening, Network Traffic Filtering) e as mapeia às técnicas ofensivas. É útil para escolher controles e justificar investimentos.</p>
<p>Exemplo: contra T1003.001 (dump de LSASS), D3FEND sugere "Credential Access Protection" (ex: Windows Defender Credential Guard), "Process Segment Execution Prevention", e monitoramento de acessos ao processo lsass.exe.</p>
<p><strong>Referências:</strong>
- <a href="https://attack.mitre.org/">MITRE ATT&amp;CK</a>
- <a href="https://mitre-attack.github.io/attack-navigator/">MITRE ATT&amp;CK Navigator</a>
- <a href="https://d3fend.mitre.org/">MITRE D3FEND</a>
- <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf">NIST SP 800-61 Rev. 2 (Incident Response)</a></p>
<hr />
<h3 id="33-cyber-kill-chain-vs-attck-como-se-complementam">3.3 Cyber Kill Chain vs ATT&amp;CK: como se complementam</h3>
<p>Embora diferentes, ambos os modelos são valiosos e se complementam:</p>
<table>
<thead>
<tr>
<th>Aspecto</th>
<th>Cyber Kill Chain</th>
<th>MITRE ATT&amp;CK</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Estrutura</strong></td>
<td>Linear, sequencial (7 etapas)</td>
<td>Matricial (14 táticas, centenas de técnicas)</td>
</tr>
<tr>
<td><strong>Foco</strong></td>
<td>Narrativa de ataque end-to-end</td>
<td>Catálogo granular de comportamentos</td>
</tr>
<tr>
<td><strong>Melhor para</strong></td>
<td>Comunicar com gestores, visualizar fluxo geral</td>
<td>Engenharia de detecção, threat hunting, análise técnica</td>
</tr>
<tr>
<td><strong>Cobertura de movimento lateral</strong></td>
<td>Implícita em "Ações"</td>
<td>Explícita (tática própria)</td>
</tr>
<tr>
<td><strong>Cobertura de identidade/cloud</strong></td>
<td>Limitada</td>
<td>Forte (matrizes específicas: Enterprise, Cloud, Mobile)</td>
</tr>
<tr>
<td><strong>Granularidade</strong></td>
<td>Baixa (etapas macro)</td>
<td>Alta (sub-técnicas, exemplos, mitigações, detecções)</td>
</tr>
</tbody>
</table>
<p><strong>Mapeamento aproximado Kill Chain → ATT&amp;CK:</strong></p>
<table>
<thead>
<tr>
<th>Etapa Kill Chain</th>
<th>Táticas ATT&amp;CK correspondentes</th>
<th>Observações</th>
</tr>
</thead>
<tbody>
<tr>
<td>1. Reconhecimento</td>
<td>Reconnaissance</td>
<td>Coleta passiva/ativa externa</td>
</tr>
<tr>
<td>2. Arsenalização</td>
<td>Resource Development</td>
<td>Ocorre fora da rede; raramente observável diretamente no host</td>
</tr>
<tr>
<td>3. Entrega</td>
<td>Initial Access</td>
<td>Phishing, Drive-by, Exploit Public-Facing Application, Supply Chain</td>
</tr>
<tr>
<td>4. Exploração</td>
<td>Execution, Privilege Escalation</td>
<td>Execução de código; pode incluir escalada imediata</td>
</tr>
<tr>
<td>5. Instalação</td>
<td>Persistence, Defense Evasion</td>
<td>Persistência + técnicas para esconder (ex: obfuscar, desabilitar logs)</td>
</tr>
<tr>
<td>6. C2</td>
<td>Command and Control</td>
<td>Comunicação bidirecional com infraestrutura do atacante</td>
</tr>
<tr>
<td>7. Ações sobre o objetivo</td>
<td>Discovery, Lateral Movement, Credential Access, Collection, Exfiltration, Impact</td>
<td>Kill Chain agrupa tudo aqui; ATT&amp;CK separa em 6+ táticas distintas</td>
</tr>
</tbody>
</table>
<p><strong>Limitações do mapeamento:</strong>
- <strong>Não é 1-para-1:</strong> um ataque real pode revisitar táticas (ex: ganhar persistência inicial, fazer discovery, movimento lateral, ganhar nova persistência em outro host).
- <strong>Arsenalização é invisível na telemetria do host:</strong> você não verá logs do seu EDR sobre o atacante compilando malware no laptop dele. Aqui, Threat Intelligence externa (ex: feeds de IOCs, análise de malware samples) é mais útil.
- <strong>Movimento Lateral não tem etapa própria na Kill Chain clássica</strong>, mas é crítico em ambientes corporativos.</p>
<p><strong>Quando usar cada modelo:</strong></p>
<ul>
<li><strong>Kill Chain:</strong> apresentações executivas, workshops com áreas de negócio, planejamento macro de controles ("precisamos melhorar detecção de C2").</li>
<li><strong>ATT&amp;CK:</strong> engenharia de detecção, criação de regras SIEM/EDR, threat hunting, exercícios de Red/Purple Team, análise de incidentes técnicos.</li>
</ul>
<p><strong>Exemplo prático híbrido:</strong></p>
<p>Um ataque de ransomware pode seguir esta narrativa:
1. <strong>(Kill Chain: Entrega / ATT&amp;CK: Initial Access - T1566.001 Spearphishing Attachment):</strong> e-mail malicioso com Excel.
2. <strong>(Kill Chain: Exploração / ATT&amp;CK: Execution - T1204.002 User Execution: Malicious File):</strong> usuário habilita macros.
3. <strong>(Kill Chain: Instalação / ATT&amp;CK: Persistence - T1547.001 Registry Run Keys):</strong> macro cria chave HKCU\Run.
4. <strong>(ATT&amp;CK: Defense Evasion - T1562.001 Impair Defenses):</strong> malware desabilita Windows Defender.
5. <strong>(Kill Chain: C2 / ATT&amp;CK: C2 - T1071.001 Application Layer Protocol: Web):</strong> malware faz beaconing HTTPS para domínio DGA.
6. <strong>(ATT&amp;CK: Credential Access - T1003.001 LSASS Memory):</strong> dump de credenciais via Mimikatz.
7. <strong>(ATT&amp;CK: Lateral Movement - T1021.002 SMB/Windows Admin Shares):</strong> espalha para outros hosts via PsExec.
8. <strong>(Kill Chain: Ações / ATT&amp;CK: Impact - T1486 Data Encrypted for Impact):</strong> criptografa arquivos e exibe nota de resgate.</p>
<p>Observe como o ATT&amp;CK dá granularidade (sub-técnicas, IDs únicos) enquanto a Kill Chain oferece a narrativa linear.</p>
<p><strong>Referências adicionais:</strong>
- <a href="https://www.lockheedmartin.com/en-us/capabilities/cyber/cyber-kill-chain.html">Lockheed Martin: Cyber Kill Chain</a>
- <a href="https://www.crowdstrike.com/en-us/cybersecurity-101/cyberattacks/cyber-kill-chain/">CrowdStrike: Cyber Kill Chain explicada</a>
- <a href="https://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html">Pyramid of Pain (David J. Bianco)</a></p>
<hr />
<h3 id="34-pyramid-of-pain-priorizando-deteccoes-eficazes">3.4 Pyramid of Pain: priorizando detecções eficazes</h3>
<p>A <strong>Pyramid of Pain</strong> (Pirâmide da Dor), criada por David J. Bianco, ajuda a priorizar quais indicadores de comprometimento (IOCs — Indicators of Compromise) e comportamentos (IOAs — Indicators of Activity) causam mais "dor" ao atacante quando detectados e bloqueados.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>                    /\
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>                   /  \  TTPs (Tactics, Techniques, Procedures)
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>                  /____\
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>                 /      \  Tools
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>                /________\
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>               /          \  Network/Host Artifacts
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>              /____________\
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>             /              \  Domain Names
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>            /________________\
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>           /                  \  IP Addresses
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>          /____________________\
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>         /                      \  Hash Values
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        /________________________\
</span></code></pre></div>
<p><strong>Níveis da pirâmide (de baixo para cima, do menos para o mais eficaz):</strong></p>
<ol>
<li><strong>Hash Values (valores hash de arquivos):</strong> fácil de trocar — atacante muda 1 byte, hash muda completamente. Bloqueio causa pouca dor.</li>
<li><strong>IP Addresses:</strong> fácil trocar de servidor ou usar proxies/CDN. Dor baixa.</li>
<li><strong>Domain Names:</strong> mais custoso trocar (registro, infraestrutura), mas ainda relativamente fácil. Dor moderada.</li>
<li><strong>Network/Host Artifacts:</strong> padrões de tráfego (ex: User-Agent customizado, estrutura de payload C2), mutexes, nomes de arquivos específicos. Exige reengenharia parcial; dor moderada-alta.</li>
<li><strong>Tools:</strong> ferramentas específicas (ex: Cobalt Strike, Mimikatz). Trocar de ferramenta exige treinar operadores, ajustar playbooks. Dor alta.</li>
<li><strong>TTPs (Tactics, Techniques, Procedures):</strong> a forma como o atacante opera — sequência de comandos, técnicas ATT&amp;CK favoritas, comportamento operacional. Mudar TTPs exige redesenhar o ataque inteiro. <strong>Dor máxima.</strong></li>
</ol>
<p><strong>Aplicação prática:</strong></p>
<ul>
<li><strong>Não se baseie apenas em hashes e IPs:</strong> esses IOCs são frágeis e exigem atualização constante.</li>
<li><strong>Invista em detecções comportamentais e baseadas em TTPs:</strong> detectar "PowerShell baixando e executando código da internet" (comportamento) é mais robusto que bloquear um hash específico.</li>
<li><strong>Use IOCs de curto prazo para resposta imediata, IOAs de longo prazo para resiliência.</strong></li>
</ul>
<p>Exemplo: em vez de criar regra "bloquear conexão para IP X.X.X.X", crie "alertar quando processo Office iniciar PowerShell com flags de download (<code>-EncodedCommand</code>, <code>DownloadString</code>)". Assim, mesmo que o atacante mude IP ou domínio, o comportamento suspeito ainda será detectado.</p>
<p><strong>Referência:</strong>
- <a href="https://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html">Pyramid of Pain - David J. Bianco</a></p>
<hr />
<h2 id="4-defesa-em-camadas-defense-in-depth">4. Defesa em Camadas (Defense-in-Depth)</h2>
<p>O conceito de <strong>defesa em camadas</strong> (defense-in-depth) parte do princípio de que não existe um único controle capaz de proteger totalmente um ambiente. Em vez disso, utiliza-se uma combinação de controles em diferentes níveis para compensar falhas e aumentar a resiliência.</p>
<p>As principais camadas de defesa são:</p>
<h3 id="41-fisica">4.1 Física</h3>
<p>Proteção do acesso físico a ambientes e equipamentos (ex: controle de acesso biométrico, câmeras de segurança, salas seguras com ar-condicionado redundante).</p>
<p><strong>Por que importa:</strong> um atacante com acesso físico pode roubar discos, instalar keyloggers de hardware, ou fazer boot de pendrives maliciosos. Datacenters e armários de rede devem ser trancados e auditados.</p>
<h3 id="42-rede">4.2 Rede</h3>
<p>Segmentação e filtragem do tráfego (ex: VLANs — redes virtuais separadas, firewalls, IDS/IPS — sistemas que detectam e bloqueiam ataques na rede, VPNs — túneis criptografados).</p>
<p><strong>Sinais/telemetrias relevantes (ambiente híbrido):</strong>
- <strong>DNS:</strong> queries para domínios DGA (gerados por algoritmo, típicos de malware), DNS-TXT incomum (usado para exfiltração ou C2).
- <strong>Proxy/Firewall:</strong> conexões para IPs de má reputação, User-Agent anômalo, tráfego para portas incomuns.
- <strong>NDR (Network Detection and Response):</strong> padrões de beaconing (conexões regulares em intervalos fixos, típicas de C2), conexões SMB/RDP externas, tráfego criptografado suspeito.</p>
<p>Exemplo: firewall detecta tráfego HTTPS para domínio registrado há 2 dias com certificado autoassinado — forte indicador de C2.</p>
<h3 id="43-endpoint">4.3 Endpoint</h3>
<p>Proteção de dispositivos finais — desktops, laptops, servidores (ex: antivírus, EDR — Endpoint Detection and Response, hardening — desabilitar serviços desnecessários, controle de aplicações — permitir apenas softwares aprovados, patches atualizados).</p>
<p><strong>Sinais/telemetrias relevantes (Windows/Linux):</strong>
- <strong>Sysmon (Windows):</strong> Event ID 1 (criação de processo), Event ID 7 (carregamento de DLL), Event ID 10 (acesso a processo — ex: dump de LSASS), Event ID 3 (conexão de rede).
- <strong>EDR:</strong> execução de LOLBins suspeitos (PowerShell, certutil, regsvr32 com flags anômalos), injeção de código, hooks em APIs sensíveis.
- <strong>PowerShell ScriptBlock Logging (Event ID 4104):</strong> scripts codificados em Base64, download de payloads, execução remota.</p>
<p>Exemplo: Sysmon detecta <code>powershell.exe</code> filho de <code>WINWORD.EXE</code> executando <code>-EncodedCommand</code> — claro sinal de macro maliciosa.</p>
<h3 id="44-identidade">4.4 Identidade</h3>
<p>Gestão rigorosa de acessos (ex: IAM — Identity and Access Management, gestão de quem pode acessar o quê; MFA — Multi-Factor Authentication, exigir senha + token/SMS; PAM — Privileged Access Management, controle de contas administrativas; SSO — Single Sign-On, login único).</p>
<p><strong>Sinais/telemetrias relevantes (híbrido):</strong>
- <strong>Azure AD / Entra ID:</strong> sign-ins de IPs anômalos, Conditional Access bloqueios, consentimento de aplicativos OAuth suspeitos, criação de service principals.
- <strong>Active Directory on-prem:</strong> eventos 4624 (logon sucesso), 4625 (falha), 4768/4769 (Kerberos TGT/TGS), 4672 (privilégios especiais atribuídos).
- <strong>AWS CloudTrail:</strong> chamadas STS AssumeRole incomuns, criação de chaves IAM, mudanças em políticas.</p>
<p>Exemplo: usuário de RH faz login às 3h da manhã de IP na Rússia, nunca visto antes — forte indicador de credential stuffing.</p>
<h3 id="45-aplicacao">4.5 Aplicação</h3>
<p>Blindagem da lógica de negócio (ex: WAF — Web Application Firewall, filtra ataques como SQL Injection; desenvolvimento seguro — OWASP Top 10; SAST/DAST — análise estática/dinâmica de código; RASP — Runtime Application Self-Protection, protege app em execução).</p>
<p><strong>Sinais/telemetrias relevantes:</strong>
- <strong>WAF logs:</strong> tentativas de SQL Injection, XSS (Cross-Site Scripting), Path Traversal.
- <strong>Logs de aplicação:</strong> erros de autenticação em massa, acessos a endpoints administrativos, mudanças de configuração críticas.</p>
<p>Exemplo: WAF bloqueia requisição <code>GET /admin.php?id=1' OR '1'='1</code> — tentativa de SQL Injection.</p>
<h3 id="46-dados">4.6 Dados</h3>
<p>Proteção e recuperação de informações (ex: classificação — marcar dados sensíveis, criptografia em trânsito/repouso, DLP — Data Loss Prevention, impedir cópia de dados sensíveis, backups imutáveis, disaster recovery).</p>
<p><strong>Sinais/telemetrias relevantes:</strong>
- <strong>DLP:</strong> usuário tentando enviar arquivos com CPFs por e-mail externo, upload de código-fonte para Dropbox pessoal.
- <strong>Cloud Storage:</strong> acessos incomuns a buckets S3/Azure Blob, mudança de permissões para público, download massivo de arquivos do SharePoint.</p>
<p>Exemplo: DLP alerta — usuário baixou 10.000 registros do banco de clientes e tentou enviá-los para Gmail.</p>
<h3 id="47-observabilidade">4.7 Observabilidade</h3>
<p>Capacidade de monitorar e reagir rapidamente (ex: SIEM — Security Information and Event Management, correlaciona logs; SOAR — Security Orchestration, Automation and Response, automatiza resposta; UEBA — User and Entity Behavior Analytics, detecta anomalias; NDR — Network Detection and Response).</p>
<p><strong>Por que importa:</strong> sem visibilidade, você está "cego" — o atacante pode estar na rede há meses e você não sabe. Logs centralizados, dashboards de KPIs de segurança (tempo médio de detecção/resposta), e alertas bem calibrados são essenciais.</p>
<p>Evite o erro comum de confiar em um único controle ("tem antivírus, logo está seguro"). O ideal é combinar camadas para cobrir lacunas e reduzir riscos. Em ambientes híbridos, isso significa integrar visibilidade on-prem (Sysmon, AD logs) com cloud (Azure AD, AWS CloudTrail, Microsoft Defender).</p>
<p><strong>Referências:</strong>
- <a href="https://www.cisecurity.org/controls/cis-controls-list">CIS Controls v8</a>
- <a href="https://www.sans.org/blog/cis-controls-v8/">SANS Top 20 Critical Security Controls</a></p>
<hr />
<h2 id="5-boas-praticas-de-engenharia-de-deteccao">5. Boas práticas de Engenharia de Detecção</h2>
<p><strong>Engenharia de Detecção</strong> é a disciplina de criar, testar e manter regras, alertas e casos de uso que identificam comportamentos maliciosos. Não basta comprar ferramentas — é preciso alimentá-las com conteúdo de qualidade.</p>
<h3 id="51-detections-as-code">5.1 Detections-as-Code</h3>
<p>Trate suas detecções como código:
- <strong>Versionamento:</strong> use Git para controlar versões de regras SIEM, queries KQL, regras Sigma.
- <strong>Peer review:</strong> outro analista revisa a regra antes de ir para produção.
- <strong>CI/CD:</strong> pipeline automatizado testa a regra contra logs históricos (datasets de teste) antes de deploy.</p>
<p>Ferramentas: Sigma (formato agnóstico de regra), Elastic Detection Rules (regras open-source da Elastic), Microsoft Sentinel Content Hub.</p>
<h3 id="52-testes-de-deteccao">5.2 Testes de Detecção</h3>
<p>Cada detecção deve ser testada:
- <strong>True Positives (TP):</strong> a regra detecta o ataque real? Rode simulações (ex: Atomic Red Team, Caldera) para validar.
- <strong>False Positives (FP):</strong> a regra gera alertas falsos? Teste com atividade legítima comum no seu ambiente.
- <strong>False Negatives (FN):</strong> a regra deixa passar alguma variante do ataque? Teste com técnicas semelhantes.</p>
<p>Exemplo: regra detecta <code>mimikatz.exe</code> — mas e se o atacante renomear para <code>update.exe</code>? Melhor detectar comportamento (acesso ao processo <code>lsass.exe</code> por processo não assinado).</p>
<h3 id="53-cobertura-attck-e-navigator">5.3 Cobertura ATT&amp;CK e Navigator</h3>
<p>Use o <strong>ATT&amp;CK Navigator</strong> para visualizar quais técnicas você cobre:
1. Liste todas as suas detecções e mapeie cada uma para técnicas ATT&amp;CK.
2. Importe no Navigator.
3. Identifique lacunas: técnicas sem detecção, especialmente as mais usadas no seu setor (ex: Threat Intelligence reports).</p>
<p>Priorize cobrir <strong>táticas críticas</strong> primeiro: Initial Access, Persistence, Credential Access, Lateral Movement, Exfiltration.</p>
<h3 id="54-hipoteses-de-threat-hunting">5.4 Hipóteses de Threat Hunting</h3>
<p><strong>Threat Hunting</strong> é busca proativa de ameaças, sem esperar alertas. Formule hipóteses baseadas em:
- <strong>Intel de ameaças:</strong> grupo X usa técnica Y, vamos caçar sinais disso aqui.
- <strong>Lacunas de detecção:</strong> não temos regra para T1003.001 (LSASS dump), vamos buscar manualmente.
- <strong>Anomalias:</strong> processo estranho <code>svchost.exe</code> rodando de pasta incomum.</p>
<p>Documente hipóteses, queries usadas, e resultados — alimenta melhoria contínua.</p>
<p><strong>Referências:</strong>
- <a href="https://github.com/SigmaHQ/sigma">Sigma HQ (regras open-source)</a>
- <a href="https://github.com/redcanaryco/atomic-red-team">Atomic Red Team (testes de técnicas ATT&amp;CK)</a>
- <a href="https://mitre-attack.github.io/attack-navigator/">MITRE ATT&amp;CK Navigator</a></p>
<hr />
<h2 id="6-mini-caso-pratico-ataque-hibrido-com-queries-de-deteccao">6. Mini-caso prático: Ataque híbrido com queries de detecção</h2>
<p>Vamos simular um ataque real em ambiente híbrido (Windows on-prem + Azure) e construir queries de detecção para cada etapa.</p>
<h3 id="cenario-campanha-de-ransomware-via-phishing">Cenário: Campanha de ransomware via phishing</h3>
<p><strong>Narrativa do ataque:</strong>
1. <strong>Initial Access:</strong> funcionário do financeiro recebe e-mail de "fatura atrasada" com anexo <code>Fatura_2025.xlsm</code> (Excel com macro).
2. <strong>Execution:</strong> usuário habilita macros; VBA executa PowerShell codificado que baixa segunda etapa.
3. <strong>Persistence:</strong> payload cria chave de registro <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code> apontando para script em <code>%APPDATA%</code>.
4. <strong>Defense Evasion:</strong> desabilita Windows Defender via PowerShell (<code>Set-MpPreference -DisableRealtimeMonitoring $true</code>).
5. <strong>C2:</strong> malware faz beaconing HTTPS para domínio DGA (<code>xj92kf1a.top</code>) a cada 15 minutos.
6. <strong>Credential Access:</strong> executa Mimikatz para dump de LSASS, obtém hash NTLM de conta de administrador de domínio.
7. <strong>Lateral Movement:</strong> usa Pass-the-Hash via PsExec para espalhar para servidor de arquivos.
8. <strong>Collection:</strong> enumera compartilhamentos de rede e copia arquivos críticos.
9. <strong>Exfiltration:</strong> envia dados para bucket S3 público (abusando de credencial AWS roubada de script).
10. <strong>Impact:</strong> criptografa arquivos e exibe nota de resgate.</p>
<hr />
<h3 id="queries-de-deteccao-kql-e-sigma">Queries de detecção (KQL e Sigma)</h3>
<h4 id="1-deteccao-office-iniciando-powershell-com-comando-codificado-execution">1. Detecção: Office iniciando PowerShell com comando codificado (Execution)</h4>
<p><strong>Plataforma:</strong> Microsoft Defender for Endpoint / Microsoft Sentinel</p>
<p><strong>KQL (Kusto Query Language):</strong>
<div class="language-kusto highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">DeviceProcessEvents</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">Timestamp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="n">ago</span><span class="p">(</span><span class="mi">30</span><span class="n">d</span><span class="p">)</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">InitiatingProcessFileName</span><span class="w"> </span><span class="n">in</span><span class="err">~</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;WINWORD.EXE&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;EXCEL.EXE&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POWERPNT.EXE&quot;</span><span class="p">)</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">FileName</span><span class="w"> </span><span class="n">in</span><span class="err">~</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;powershell.exe&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;powershell_ise.exe&quot;</span><span class="p">)</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">ProcessCommandLine</span><span class="w"> </span><span class="n">has_any</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;-enc&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;-EncodedCommand&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;FromBase64String&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DownloadString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IEX&quot;</span><span class="p">)</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">Timestamp</span><span class="p">,</span><span class="w"> </span><span class="n">DeviceName</span><span class="p">,</span><span class="w"> </span><span class="n">AccountName</span><span class="p">,</span><span class="w"> </span><span class="n">InitiatingProcessFileName</span><span class="p">,</span><span class="w"> </span><span class="n">ProcessCommandLine</span>
</span></code></pre></div></p>
<p><strong>O que detectar:</strong> documento Office abrindo PowerShell com sinais de código codificado/download — típico de macros maliciosas.</p>
<hr />
<h4 id="2-deteccao-alteracao-de-persistencia-via-chave-de-registro-persistence">2. Detecção: Alteração de persistência via chave de registro (Persistence)</h4>
<p><strong>Plataforma:</strong> Microsoft Defender / Sysmon</p>
<p><strong>KQL:</strong>
<div class="language-kusto highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">DeviceRegistryEvents</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">Timestamp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="n">ago</span><span class="p">(</span><span class="mi">7</span><span class="n">d</span><span class="p">)</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">RegistryKey</span><span class="w"> </span><span class="k">has</span><span class="w"> </span><span class="s">@&quot;Software\Microsoft\Windows\CurrentVersion\Run&quot;</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">RegistryValueName</span><span class="w"> </span><span class="p">!=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">RegistryValueData</span><span class="w"> </span><span class="n">has_any</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;powershell&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;cmd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;wscript&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;cscript&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;.vbs&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;.js&quot;</span><span class="p">)</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">Timestamp</span><span class="p">,</span><span class="w"> </span><span class="n">DeviceName</span><span class="p">,</span><span class="w"> </span><span class="n">AccountName</span><span class="p">,</span><span class="w"> </span><span class="n">RegistryKey</span><span class="p">,</span><span class="w"> </span><span class="n">RegistryValueName</span><span class="p">,</span><span class="w"> </span><span class="n">RegistryValueData</span><span class="p">,</span><span class="w"> </span><span class="n">InitiatingProcessFileName</span>
</span></code></pre></div></p>
<p><strong>O que detectar:</strong> criação/modificação de chaves de inicialização automática apontando para scripts — forte indicador de persistência.</p>
<hr />
<h4 id="3-deteccao-desabilitacao-do-windows-defender-defense-evasion">3. Detecção: Desabilitação do Windows Defender (Defense Evasion)</h4>
<p><strong>Plataforma:</strong> Microsoft Defender / Sysmon</p>
<p><strong>KQL:</strong>
<div class="language-kusto highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">DeviceProcessEvents</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">Timestamp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="n">ago</span><span class="p">(</span><span class="mi">7</span><span class="n">d</span><span class="p">)</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">FileName</span><span class="w"> </span><span class="n">in</span><span class="err">~</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;powershell.exe&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;powershell_ise.exe&quot;</span><span class="p">)</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">ProcessCommandLine</span><span class="w"> </span><span class="n">has_any</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;Set-MpPreference&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DisableRealtimeMonitoring&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DisableBehaviorMonitoring&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DisableIOAVProtection&quot;</span><span class="p">)</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">Timestamp</span><span class="p">,</span><span class="w"> </span><span class="n">DeviceName</span><span class="p">,</span><span class="w"> </span><span class="n">AccountName</span><span class="p">,</span><span class="w"> </span><span class="n">ProcessCommandLine</span><span class="p">,</span><span class="w"> </span><span class="n">InitiatingProcessFileName</span>
</span></code></pre></div></p>
<p><strong>O que detectar:</strong> comandos PowerShell que desativam proteções do Defender — técnica comum de malware.</p>
<hr />
<h4 id="4-deteccao-dns-queries-para-dominios-dga-c2">4. Detecção: DNS queries para domínios DGA (C2)</h4>
<p><strong>Plataforma:</strong> Azure Firewall / DNS logs / Proxy</p>
<p><strong>KQL (Azure Firewall DNS Proxy Logs):</strong>
<div class="language-kusto highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">AzureDiagnostics</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">Category</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;AzureFirewallDnsProxy&quot;</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">TimeGenerated</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="n">ago</span><span class="p">(</span><span class="mi">24</span><span class="n">h</span><span class="p">)</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span><span class="n">QueryName</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tolower</span><span class="p">(</span><span class="n">tostring</span><span class="p">(</span><span class="n">parse_json</span><span class="p">(</span><span class="n">msg_s</span><span class="p">)</span><span class="err">.</span><span class="n">query</span><span class="p">))</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">QueryName</span><span class="w"> </span><span class="k">matches regex</span><span class="w"> </span><span class="s">@&quot;^[a-z0-9]{8,12}\.(top|xyz|info|club)$&quot;</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="p">|</span><span class="w"> </span><span class="k">summarize</span><span class="w"> </span><span class="n">Count</span><span class="p">=</span><span class="k">count</span><span class="p">()</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">QueryName</span><span class="p">,</span><span class="w"> </span><span class="n">SourceIp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ClientIp</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">Count</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">5</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="p">|</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Count</span><span class="w"> </span><span class="n">desc</span>
</span></code></pre></div></p>
<p><strong>O que detectar:</strong> domínios com nomes aleatórios curtos e TLDs suspeitos (.top, .xyz) consultados repetidamente — padrão DGA típico de malware.</p>
<hr />
<h4 id="5-deteccao-acesso-ao-processo-lsass-credential-access">5. Detecção: Acesso ao processo LSASS (Credential Access)</h4>
<p><strong>Plataforma:</strong> Sysmon (Event ID 10)</p>
<p><strong>Sigma:</strong>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Suspicious Access to LSASS Process</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Detecta acessos ao processo lsass.exe por processos não assinados ou incomuns</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="nt">logsource</span><span class="p">:</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">  </span><span class="nt">product</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">windows</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">  </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sysmon</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="nt">detection</span><span class="p">:</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">  </span><span class="nt">selection</span><span class="p">:</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">    </span><span class="nt">EventID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">    </span><span class="nt">TargetImage|endswith</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;\lsass.exe&#39;</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">    </span><span class="nt">GrantedAccess</span><span class="p">:</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;0x1010&#39;</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;0x1410&#39;</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;0x1438&#39;</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">  </span><span class="nt">filter</span><span class="p">:</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">    </span><span class="nt">SourceImage|endswith</span><span class="p">:</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;\wmiprvse.exe&#39;</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;\taskmgr.exe&#39;</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;\procexp64.exe&#39;</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">  </span><span class="nt">condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">selection and not filter</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">high</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="nt">falsepositives</span><span class="p">:</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ferramentas administrativas legítimas (Process Explorer, alguns antivírus)</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="nt">tags</span><span class="p">:</span>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">attack.credential_access</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">attack.t1003.001</span>
</span></code></pre></div></p>
<p><strong>O que detectar:</strong> processos acessando memória do LSASS (onde ficam credenciais) — Mimikatz, Cobalt Strike, outros dumpers.</p>
<hr />
<h4 id="6-deteccao-uso-de-lolbin-regsvr32-para-download-remoto-defense-evasion-execution">6. Detecção: Uso de LOLBin regsvr32 para download remoto (Defense Evasion / Execution)</h4>
<p><strong>Plataforma:</strong> Microsoft Defender / Sysmon</p>
<p><strong>KQL:</strong>
<div class="language-kusto highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">DeviceProcessEvents</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">Timestamp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="n">ago</span><span class="p">(</span><span class="mi">7</span><span class="n">d</span><span class="p">)</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">FileName</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">&quot;regsvr32.exe&quot;</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">ProcessCommandLine</span><span class="w"> </span><span class="n">has_any</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;http://&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;https://&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;.sct&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;scrobj.dll&quot;</span><span class="p">)</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">Timestamp</span><span class="p">,</span><span class="w"> </span><span class="n">DeviceName</span><span class="p">,</span><span class="w"> </span><span class="n">AccountName</span><span class="p">,</span><span class="w"> </span><span class="n">ProcessCommandLine</span><span class="p">,</span><span class="w"> </span><span class="n">InitiatingProcessFileName</span>
</span></code></pre></div></p>
<p><strong>O que detectar:</strong> regsvr32 sendo abusado para executar scripts remotos (técnica bypass de AppLocker/UAC).</p>
<hr />
<h4 id="7-deteccao-movimento-lateral-via-psexec-lateral-movement">7. Detecção: Movimento lateral via PsExec (Lateral Movement)</h4>
<p><strong>Plataforma:</strong> Microsoft Defender / Sysmon</p>
<p><strong>KQL:</strong>
<div class="language-kusto highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">DeviceProcessEvents</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">Timestamp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="n">ago</span><span class="p">(</span><span class="mi">7</span><span class="n">d</span><span class="p">)</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">FileName</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">&quot;psexec.exe&quot;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">ProcessCommandLine</span><span class="w"> </span><span class="k">has</span><span class="w"> </span><span class="s">&quot;psexec&quot;</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">     </span><span class="k">or</span><span class="w"> </span><span class="p">(</span><span class="n">FileName</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">&quot;psexesvc.exe&quot;</span><span class="p">)</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">Timestamp</span><span class="p">,</span><span class="w"> </span><span class="n">DeviceName</span><span class="p">,</span><span class="w"> </span><span class="n">AccountName</span><span class="p">,</span><span class="w"> </span><span class="n">ProcessCommandLine</span><span class="p">,</span><span class="w"> </span><span class="n">InitiatingProcessAccountName</span>
</span></code></pre></div></p>
<p><strong>O que detectar:</strong> uso de PsExec (ferramenta Sysinternals comum para administração, mas muito abusada por atacantes para movimento lateral).</p>
<hr />
<h4 id="8-deteccao-consentimento-de-aplicativo-oauth-suspeito-cloud-azure">8. Detecção: Consentimento de aplicativo OAuth suspeito (Cloud - Azure)</h4>
<p><strong>Plataforma:</strong> Microsoft Sentinel / Azure AD logs</p>
<p><strong>KQL:</strong>
<div class="language-kusto highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">AuditLogs</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">TimeGenerated</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="n">ago</span><span class="p">(</span><span class="mi">7</span><span class="n">d</span><span class="p">)</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">OperationName</span><span class="w"> </span><span class="n">has_any</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;Consent to application&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Add service principal&quot;</span><span class="p">)</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">Result</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">&quot;success&quot;</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span><span class="n">AppDisplayName</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">parse_json</span><span class="p">(</span><span class="n">tostring</span><span class="p">(</span><span class="n">TargetResources</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="err">.</span><span class="n">displayName</span><span class="p">)</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span><span class="n">UserPrincipalName</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">InitiatedBy</span><span class="err">.</span><span class="n">user</span><span class="err">.</span><span class="n">userPrincipalName</span><span class="p">)</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">TimeGenerated</span><span class="p">,</span><span class="w"> </span><span class="n">UserPrincipalName</span><span class="p">,</span><span class="w"> </span><span class="n">AppDisplayName</span><span class="p">,</span><span class="w"> </span><span class="n">OperationName</span><span class="p">,</span><span class="w"> </span><span class="n">CorrelationId</span>
</span></code></pre></div></p>
<p><strong>O que detectar:</strong> usuários concedendo permissões a apps OAuth desconhecidos — técnica de phishing moderno para roubar acesso a Office 365/Azure sem senha.</p>
<hr />
<h4 id="9-deteccao-acesso-anomalo-a-bucket-s3-exfiltration-aws">9. Detecção: Acesso anômalo a bucket S3 (Exfiltration - AWS)</h4>
<p><strong>Plataforma:</strong> AWS CloudTrail / Splunk / Sentinel</p>
<p><strong>KQL (assumindo CloudTrail ingerido no Sentinel):</strong>
<div class="language-kusto highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">AWSCloudTrail</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">TimeGenerated</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="n">ago</span><span class="p">(</span><span class="mi">24</span><span class="n">h</span><span class="p">)</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">EventName</span><span class="w"> </span><span class="n">in</span><span class="err">~</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;GetObject&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ListObjects&quot;</span><span class="p">)</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">isnotempty</span><span class="p">(</span><span class="n">SourceIpAddress</span><span class="p">)</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="p">|</span><span class="w"> </span><span class="k">summarize</span><span class="w"> </span><span class="n">Count</span><span class="p">=</span><span class="k">count</span><span class="p">(),</span><span class="w"> </span><span class="n">DataTransferred</span><span class="p">=</span><span class="n">sum</span><span class="p">(</span><span class="n">ResponseElements</span><span class="err">.</span><span class="n">bytesTransferredOut</span><span class="p">)</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">SourceIpAddress</span><span class="p">,</span><span class="w"> </span><span class="n">UserIdentityArn</span><span class="p">,</span><span class="w"> </span><span class="n">BucketName</span><span class="p">=</span><span class="n">tostring</span><span class="p">(</span><span class="n">RequestParameters</span><span class="err">.</span><span class="n">bucketName</span><span class="p">)</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">Count</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">DataTransferred</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">10000000</span><span class="w"> </span><span class="c">// mais de 10MB ou 100 acessos</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="p">|</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">DataTransferred</span><span class="w"> </span><span class="n">desc</span>
</span></code></pre></div></p>
<p><strong>O que detectar:</strong> downloads massivos de S3 de IP externo ou usuário incomum — possível exfiltração de dados.</p>
<hr />
<h3 id="observacoes-sobre-as-queries">Observações sobre as queries</h3>
<ul>
<li><strong>KQL</strong> é a linguagem nativa de Microsoft Sentinel, Defender, Azure Data Explorer.</li>
<li><strong>Sigma</strong> é formato agnóstico — pode ser convertido para KQL, Splunk, Elastic, QRadar, etc.</li>
<li>Queries reais precisam de <strong>tuning</strong> no seu ambiente: ajustar thresholds, adicionar exceções (ex: admins legítimos usando PsExec), correlacionar múltiplos eventos.</li>
<li><strong>Teste antes de produção:</strong> rode queries em modo de auditoria por dias/semanas, analise falsos positivos, ajuste.</li>
</ul>
<p><strong>Ferramentas úteis:</strong>
- <a href="https://uncoder.io/">Uncoder.io</a> — converte Sigma para KQL, Splunk, Elastic, etc.
- <a href="https://github.com/redcanaryco/atomic-red-team">Atomic Red Team</a> — teste técnicas ATT&amp;CK para validar detecções.
- <a href="https://learn.microsoft.com/en-us/azure/sentinel/sentinel-content-hub">Microsoft Sentinel Content Hub</a> — regras prontas.</p>
<hr />
<h2 id="7-glossario-basico">7. Glossário básico</h2>
<p>Termos técnicos citados nesta aula, em ordem alfabética:</p>
<ul>
<li><strong>ATP (Advanced Threat Protection):</strong> soluções que detectam ameaças avançadas e persistentes.</li>
<li><strong>Beaconing:</strong> padrão de comunicação regular entre malware e servidor C2 (ex: a cada 10 min).</li>
<li><strong>C2 (Command and Control):</strong> infraestrutura do atacante para controlar sistemas comprometidos.</li>
<li><strong>CloudTrail:</strong> serviço da AWS que registra chamadas de API (quem fez o quê, quando).</li>
<li><strong>Credential Stuffing:</strong> ataque automatizado usando pares usuário/senha vazados de outros sites.</li>
<li><strong>DGA (Domain Generation Algorithm):</strong> algoritmo que cria domínios aleatórios para C2, dificultando bloqueio.</li>
<li><strong>DLP (Data Loss Prevention):</strong> ferramentas que impedem vazamento de dados sensíveis (ex: bloquear envio de CPFs por e-mail).</li>
<li><strong>Drive-by Download:</strong> infecção apenas visitando site comprometido, sem clicar em nada.</li>
<li><strong>EDR (Endpoint Detection and Response):</strong> ferramenta avançada de proteção de endpoints, com visibilidade profunda e caça a ameaças (ex: Microsoft Defender for Endpoint, CrowdStrike Falcon).</li>
<li><strong>IAM (Identity and Access Management):</strong> gestão de identidades e acessos (quem pode acessar o quê).</li>
<li><strong>IDS/IPS (Intrusion Detection/Prevention System):</strong> sistemas que detectam (IDS) ou bloqueiam (IPS) ataques na rede.</li>
<li><strong>IOA (Indicator of Activity):</strong> indicadores de atividade/comportamento malicioso (ex: PowerShell baixando executável).</li>
<li><strong>IOC (Indicator of Compromise):</strong> indicadores de comprometimento (ex: hash de malware, IP de C2, domínio malicioso).</li>
<li><strong>KQL (Kusto Query Language):</strong> linguagem de consulta usada no Microsoft Sentinel, Defender, Azure Data Explorer.</li>
<li><strong>LOLBins (Living Off the Land Binaries):</strong> ferramentas legítimas do sistema operacional abusadas por atacantes (ex: PowerShell, certutil, regsvr32).</li>
<li><strong>MFA (Multi-Factor Authentication):</strong> autenticação em múltiplos fatores (ex: senha + código SMS).</li>
<li><strong>NDR (Network Detection and Response):</strong> solução que monitora tráfego de rede para detectar ameaças.</li>
<li><strong>OAuth:</strong> protocolo de autorização usado por apps para acessar recursos (ex: "logar com Google").</li>
<li><strong>PAM (Privileged Access Management):</strong> gestão de contas privilegiadas (administradores).</li>
<li><strong>Pass-the-Hash:</strong> técnica de roubar hash de senha (sem a senha em texto claro) e usá-lo para autenticar.</li>
<li><strong>RASP (Runtime Application Self-Protection):</strong> proteção que roda dentro da aplicação, detectando ataques em tempo real.</li>
<li><strong>SAST/DAST (Static/Dynamic Application Security Testing):</strong> análise de segurança de código (estática) ou aplicação rodando (dinâmica).</li>
<li><strong>SIEM (Security Information and Event Management):</strong> plataforma que coleta, correlaciona logs e gera alertas (ex: Splunk, Microsoft Sentinel, QRadar).</li>
<li><strong>Sigma:</strong> formato open-source e agnóstico de regras de detecção, conversível para várias plataformas.</li>
<li><strong>SOAR (Security Orchestration, Automation and Response):</strong> automação de resposta a incidentes (ex: isolar máquina infectada automaticamente).</li>
<li><strong>SSO (Single Sign-On):</strong> login único para acessar múltiplos sistemas.</li>
<li><strong>STS (Security Token Service):</strong> serviço AWS que gera tokens temporários para assumir roles IAM.</li>
<li><strong>Sysmon (System Monitor):</strong> ferramenta Microsoft gratuita que gera logs detalhados de processos, rede, registry no Windows.</li>
<li><strong>TTP (Tactics, Techniques, Procedures):</strong> comportamento operacional do atacante (como ele age).</li>
<li><strong>UEBA (User and Entity Behavior Analytics):</strong> análise comportamental de usuários/entidades para detectar anomalias (ex: usuário de RH acessando banco de dados financeiro).</li>
<li><strong>WAF (Web Application Firewall):</strong> firewall específico para proteger aplicações web (bloqueia SQL Injection, XSS, etc.).</li>
</ul>
<hr />
<p><strong>Referências finais:</strong>
- <a href="https://attack.mitre.org/">MITRE ATT&amp;CK</a>
- <a href="https://d3fend.mitre.org/">MITRE D3FEND</a>
- <a href="https://www.nist.gov/cyberframework">NIST Cybersecurity Framework</a>
- <a href="https://www.cisecurity.org/controls/">CIS Controls v8</a>
- <a href="https://www.sans.org/white-papers/">SANS Reading Room (papers técnicos)</a>
- <a href="https://learn.microsoft.com/en-us/security/cybersecurity-reference-architecture/mcra">Microsoft Cybersecurity Reference Architectures</a></p>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["content.code.copy"], "search": "../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado para \u00e1rea de transfer\u00eancia", "clipboard.copy": "Copiar para \u00e1rea de transfer\u00eancia", "search.result.more.one": "mais 1 nesta p\u00e1gina", "search.result.more.other": "# mais nesta p\u00e1gina", "search.result.none": "Nenhum documento encontrado", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Digite para iniciar a busca", "search.result.term.missing": "Ausente", "select.version": "Selecione a vers\u00e3o"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>